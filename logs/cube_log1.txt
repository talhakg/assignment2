2025-10-12 13:54:36,313 - INFO - ============================================================
2025-10-12 13:54:36,313 - INFO - DATA WAREHOUSE LAB - SQL QUERY EXECUTION
2025-10-12 13:54:36,313 - INFO - ============================================================
2025-10-12 13:54:36,313 - INFO - Execution started at: 2025-10-12 13:54:36
2025-10-12 13:54:36,313 - INFO - SQL file: queries/cube_example.sql
2025-10-12 13:54:36,313 - INFO - Data folder: data/sample_schema/
2025-10-12 13:54:36,313 - INFO - Log file: logs/cube_log1.txt
2025-10-12 13:54:36,313 - INFO - ============================================================
2025-10-12 13:54:36,318 - INFO - ✓ Connected to DuckDB
2025-10-12 13:54:36,318 - INFO - Found 3 CSV file(s) in 'data/sample_schema/'
2025-10-12 13:54:36,321 - INFO - ✓ Loaded 'dim_product.csv' as table 'dim_product' (20 rows, 7 columns)
2025-10-12 13:54:36,322 - INFO - ✓ Loaded 'dim_customer.csv' as table 'dim_customer' (20 rows, 7 columns)
2025-10-12 13:54:36,323 - INFO - ✓ Loaded 'fact_sales.csv' as table 'fact_sales' (30 rows, 10 columns)
2025-10-12 13:54:36,323 - INFO - ✓ Successfully loaded 3 table(s): dim_product, dim_customer, fact_sales
2025-10-12 13:54:36,323 - INFO - ✓ Successfully read SQL file 'queries/cube_example.sql'
2025-10-12 13:54:36,323 - INFO - Executing SQL query...
2025-10-12 13:54:36,323 - INFO - Query:
-- CUBE Example: Multi-dimensional Analysis
-- This query demonstrates CUBE functionality for analyzing sales data
-- across multiple dimensions (region, category, age_group)

SELECT 
    c.region,
    p.category,
    c.age_group,
    COUNT(*) as total_orders,
    SUM(f.total_amount) as total_sales,
    AVG(f.total_amount) as avg_order_value,
    SUM(f.quantity) as total_quantity
FROM fact_sales f
JOIN dim_customer c ON f.customer_id = c.customer_id
JOIN dim_product p ON f.product_id = p.product_id
GROUP BY CUBE (c.region, p.category, c.age_group)
ORDER BY 
    c.region NULLS LAST,
    p.category NULLS LAST,
    c.age_group NULLS LAST;

2025-10-12 13:54:36,329 - INFO - ✓ Query executed successfully. Result: 73 rows, 7 columns
2025-10-12 13:54:36,329 - INFO - 
=== QUERY RESULTS PREVIEW (First 10 rows) ===
2025-10-12 13:54:36,329 - INFO - Columns: 
['region', 'category', 'age_group', 'total_orders', 'total_sales', 'avg_order_value', 'total_quantity']
2025-10-12 13:54:36,329 - INFO - 
2025-10-12 13:54:36,331 - INFO - 
          region   category age_group  total_orders  total_sales  avg_order_value  total_quantity
         Alberta  Furniture     35-44             1       899.99       899.990000             1.0
         Alberta  Furniture     45-54             1       199.99       199.990000             1.0
         Alberta  Furniture      None             2      1099.98       549.990000             2.0
         Alberta Technology     45-54             1      2399.99      2399.990000             1.0
         Alberta Technology      None             1      2399.99      2399.990000             1.0
         Alberta       None     35-44             1       899.99       899.990000             1.0
         Alberta       None     45-54             2      2599.98      1299.990000             2.0
         Alberta       None      None             3      3499.97      1166.656667             3.0
British Columbia Technology     25-34             1       359.98       359.980000             2.0
British Columbia Technology     35-44             1      4799.98      4799.980000             2.0
2025-10-12 13:54:36,332 - INFO - 
... (63 more rows not shown)
2025-10-12 13:54:36,332 - INFO - ==================================================
2025-10-12 13:54:36,333 - INFO - ✓ Query results saved to 'outputs/cube_example_output.csv'
2025-10-12 13:54:36,333 - INFO - ============================================================
2025-10-12 13:54:36,333 - INFO - EXECUTION COMPLETED SUCCESSFULLY
2025-10-12 13:54:36,333 - INFO - Results saved to: outputs/cube_example_output.csv
2025-10-12 13:54:36,333 - INFO - Logs saved to: logs/cube_log1.txt
2025-10-12 13:54:36,333 - INFO - ============================================================
2025-10-12 13:54:36,334 - INFO - ✓ DuckDB connection closed
